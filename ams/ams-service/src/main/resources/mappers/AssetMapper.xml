<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.zb.fincore.ams.service.dal.dao.AssetDao">
    <resultMap id="BaseResultMap" type="com.zb.fincore.ams.service.dal.model.Asset">
        <id column="id" property="id" jdbcType="BIGINT"/>
        <result column="asset_code" property="assetCode" jdbcType="VARCHAR"/>
        <result column="ext_asset_code" property="extAssetCode" jdbcType="VARCHAR"/>
        <result column="asset_name" property="assetName" jdbcType="VARCHAR"/>
        <result column="asset_type" property="assetType" jdbcType="TINYINT"/>
        <result column="collect_status" property="collectStatus" jdbcType="TINYINT"/>
        <result column="approval_require_sign" property="approvalRequireSign" jdbcType="VARCHAR"/>
        <result column="approval_sign" property="approvalSign" jdbcType="VARCHAR"/>
        <result column="approval_status" property="approvalStatus" jdbcType="TINYINT"/>
        <result column="asset_amount" property="assetAmount" jdbcType="DECIMAL"/>
        <result column="distribute_amount" property="distributeAmount" jdbcType="DECIMAL"/>
        <result column="stock_amount" property="stockAmount" jdbcType="DECIMAL"/>
        <result column="frozen_amount" property="frozenAmount" jdbcType="DECIMAL"/>
        <result column="sale_amount" property="saleAmount" jdbcType="DECIMAL"/>
        <result column="finance_subject_id" property="financeSubjectId" jdbcType="BIGINT"/>
        <result column="finance_subject_code" property="financeSubjectCode" jdbcType="VARCHAR"/>
        <result column="establish_time" property="establishTime" jdbcType="TIMESTAMP"/>
        <result column="value_start_time" property="valueStartTime" jdbcType="TIMESTAMP"/>
        <result column="value_end_time" property="valueEndTime" jdbcType="TIMESTAMP"/>
        <result column="expire_time" property="expireTime" jdbcType="TIMESTAMP"/>
        <result column="transfer_lock_days" property="transferLockDays" jdbcType="INTEGER"/>
        <result column="value_days" property="valueDays" jdbcType="INTEGER"/>
        <result column="yield_rate" property="yieldRate" jdbcType="DECIMAL"/>
        <result column="min_invest_amount" property="minInvestAmount" jdbcType="DECIMAL"/>
        <result column="increase_amount" property="increaseAmount" jdbcType="DECIMAL"/>
        <result column="repayment_type" property="repaymentType" jdbcType="TINYINT"/>
        <result column="asset_desc" property="assetDesc" jdbcType="VARCHAR"/>
        <result column="finance_project" property="financeProject" jdbcType="VARCHAR"/>
        <result column="parent_asset_code" property="parentAssetCode" jdbcType="VARCHAR"/>
        <result column="provide_loan_code" property="provideLoanCode" jdbcType="VARCHAR"/>
        <result column="project_desc" property="projectDesc" jdbcType="LONGVARCHAR"/>
        <result column="repay_guarentee_mode" property="repayGuarenteeMode" jdbcType="LONGVARCHAR"/>
        <result column="credit_mode" property="creditMode" jdbcType="LONGVARCHAR"/>
        <result column="register_type" property="registerType" jdbcType="TINYINT"/>
        <result column="storage_status" property="storageStatus" jdbcType="TINYINT"/>
        <result column="publish_info" property="publishInfo" jdbcType="LONGVARCHAR"/>
        <result column="version" property="version" jdbcType="INTEGER"/>
        <result column="create_time" property="createTime" jdbcType="TIMESTAMP"/>
        <result column="create_by" property="createBy" jdbcType="VARCHAR"/>
        <result column="modify_time" property="modifyTime" jdbcType="TIMESTAMP"/>
        <result column="modify_by" property="modifyBy" jdbcType="VARCHAR"/>
    </resultMap>

    <resultMap id="AssetDetailResultMap" type="com.zb.fincore.ams.service.dal.model.Asset">
        <id column="id" property="id" jdbcType="BIGINT"/>
        <result column="asset_code" property="assetCode" jdbcType="VARCHAR"/>
        <result column="ext_asset_code" property="extAssetCode" jdbcType="VARCHAR"/>
        <result column="asset_name" property="assetName" jdbcType="VARCHAR"/>
        <result column="asset_type" property="assetType" jdbcType="TINYINT"/>
        <result column="collect_status" property="collectStatus" jdbcType="TINYINT"/>
        <result column="approval_require_sign" property="approvalRequireSign" jdbcType="VARCHAR"/>
        <result column="approval_sign" property="approvalSign" jdbcType="VARCHAR"/>
        <result column="approval_status" property="approvalStatus" jdbcType="TINYINT"/>
        <result column="asset_amount" property="assetAmount" jdbcType="DECIMAL"/>
        <result column="distribute_amount" property="distributeAmount" jdbcType="DECIMAL"/>
        <result column="stock_amount" property="stockAmount" jdbcType="DECIMAL"/>
        <result column="frozen_amount" property="frozenAmount" jdbcType="DECIMAL"/>
        <result column="sale_amount" property="saleAmount" jdbcType="DECIMAL"/>
        <result column="finance_subject_id" property="financeSubjectId" jdbcType="BIGINT"/>
        <result column="finance_subject_code" property="financeSubjectCode" jdbcType="VARCHAR"/>
        <result column="establish_time" property="establishTime" jdbcType="TIMESTAMP"/>
        <result column="value_start_time" property="valueStartTime" jdbcType="TIMESTAMP"/>
        <result column="value_end_time" property="valueEndTime" jdbcType="TIMESTAMP"/>
        <result column="expire_time" property="expireTime" jdbcType="TIMESTAMP"/>
        <result column="transfer_lock_days" property="transferLockDays" jdbcType="INTEGER"/>
        <result column="value_days" property="valueDays" jdbcType="INTEGER"/>
        <result column="yield_rate" property="yieldRate" jdbcType="DECIMAL"/>
        <result column="min_invest_amount" property="minInvestAmount" jdbcType="DECIMAL"/>
        <result column="increase_amount" property="increaseAmount" jdbcType="DECIMAL"/>
        <result column="repayment_type" property="repaymentType" jdbcType="TINYINT"/>
        <result column="asset_desc" property="assetDesc" jdbcType="VARCHAR"/>
        <result column="finance_project" property="financeProject" jdbcType="VARCHAR"/>
        <result column="parent_asset_code" property="parentAssetCode" jdbcType="VARCHAR"/>
        <result column="provide_loan_code" property="provideLoanCode" jdbcType="VARCHAR"/>
        <result column="project_desc" property="projectDesc" jdbcType="LONGVARCHAR"/>
        <result column="repay_guarentee_mode" property="repayGuarenteeMode" jdbcType="LONGVARCHAR"/>
        <result column="credit_mode" property="creditMode" jdbcType="LONGVARCHAR"/>
        <result column="register_type" property="registerType" jdbcType="TINYINT"/>
        <result column="storage_status" property="storageStatus" jdbcType="TINYINT"/>
        <result column="publish_info" property="publishInfo" jdbcType="LONGVARCHAR"/>
        <result column="version" property="version" jdbcType="INTEGER"/>
        <result column="create_time" property="createTime" jdbcType="TIMESTAMP"/>
        <result column="create_by" property="createBy" jdbcType="VARCHAR"/>
        <result column="modify_time" property="modifyTime" jdbcType="TIMESTAMP"/>
        <result column="modify_by" property="modifyBy" jdbcType="VARCHAR"/>
        <association property="financeSubject" javaType="com.zb.fincore.ams.service.dal.model.FinanceSubject">
            <id column="financeSubject_id" property="id" jdbcType="BIGINT"/>
            <result column="subject_code" property="subjectCode" jdbcType="VARCHAR"/>
            <result column="subject_name" property="subjectName" jdbcType="VARCHAR"/>
            <result column="cert_type" property="certType" jdbcType="TINYINT"/>
            <result column="cert_no" property="certNo" jdbcType="VARCHAR"/>
            <result column="registered_capital" property="registeredCapital" jdbcType="DECIMAL"/>
            <result column="subject_address" property="subjectAddress" jdbcType="VARCHAR"/>
            <result column="legal_person_name" property="legalPersonName" jdbcType="VARCHAR"/>
            <result column="legal_person_cert_no" property="legalPersonCertNo" jdbcType="VARCHAR"/>
            <result column="business_scope" property="businessScope" jdbcType="LONGVARCHAR"/>
            <result column="introduction" property="introduction" jdbcType="LONGVARCHAR"/>
            <result column="financeSubject_create_time" property="createTime" jdbcType="TIMESTAMP"/>
            <result column="financeSubject_create_by" property="createBy" jdbcType="VARCHAR"/>
            <result column="financeSubject_modify_time" property="modifyTime" jdbcType="TIMESTAMP"/>
            <result column="financeSubject_modify_by" property="modifyBy" jdbcType="VARCHAR"/>
        </association>
    </resultMap>

    <resultMap id="AssetRecordResultMap" type="com.zb.fincore.ams.service.dal.model.Asset">
        <id column="id" property="id" jdbcType="BIGINT"/>
        <result column="asset_code" property="assetCode" jdbcType="VARCHAR"/>
        <result column="ext_asset_code" property="extAssetCode" jdbcType="VARCHAR"/>
        <result column="asset_name" property="assetName" jdbcType="VARCHAR"/>
        <result column="asset_type" property="assetType" jdbcType="TINYINT"/>
        <result column="collect_status" property="collectStatus" jdbcType="TINYINT"/>
        <result column="approval_require_sign" property="approvalRequireSign" jdbcType="VARCHAR"/>
        <result column="approval_sign" property="approvalSign" jdbcType="VARCHAR"/>
        <result column="approval_status" property="approvalStatus" jdbcType="TINYINT"/>
        <result column="asset_amount" property="assetAmount" jdbcType="DECIMAL"/>
        <result column="distribute_amount" property="distributeAmount" jdbcType="DECIMAL"/>
        <result column="stock_amount" property="stockAmount" jdbcType="DECIMAL"/>
        <result column="frozen_amount" property="frozenAmount" jdbcType="DECIMAL"/>
        <result column="sale_amount" property="saleAmount" jdbcType="DECIMAL"/>
        <result column="finance_subject_id" property="financeSubjectId" jdbcType="BIGINT"/>
        <result column="finance_subject_code" property="financeSubjectCode" jdbcType="VARCHAR"/>
        <result column="establish_time" property="establishTime" jdbcType="TIMESTAMP"/>
        <result column="value_start_time" property="valueStartTime" jdbcType="TIMESTAMP"/>
        <result column="value_end_time" property="valueEndTime" jdbcType="TIMESTAMP"/>
        <result column="expire_time" property="expireTime" jdbcType="TIMESTAMP"/>
        <result column="transfer_lock_days" property="transferLockDays" jdbcType="INTEGER"/>
        <result column="value_days" property="valueDays" jdbcType="INTEGER"/>
        <result column="yield_rate" property="yieldRate" jdbcType="DECIMAL"/>
        <result column="min_invest_amount" property="minInvestAmount" jdbcType="DECIMAL"/>
        <result column="increase_amount" property="increaseAmount" jdbcType="DECIMAL"/>
        <result column="repayment_type" property="repaymentType" jdbcType="TINYINT"/>
        <result column="asset_desc" property="assetDesc" jdbcType="VARCHAR"/>
        <result column="finance_project" property="financeProject" jdbcType="VARCHAR"/>
        <result column="parent_asset_code" property="parentAssetCode" jdbcType="VARCHAR"/>
        <result column="provide_loan_code" property="provideLoanCode" jdbcType="VARCHAR"/>
        <result column="project_desc" property="projectDesc" jdbcType="LONGVARCHAR"/>
        <result column="repay_guarentee_mode" property="repayGuarenteeMode" jdbcType="LONGVARCHAR"/>
        <result column="credit_mode" property="creditMode" jdbcType="LONGVARCHAR"/>
        <result column="register_type" property="registerType" jdbcType="TINYINT"/>
        <result column="storage_status" property="storageStatus" jdbcType="TINYINT"/>
        <result column="publish_info" property="publishInfo" jdbcType="LONGVARCHAR"/>
        <result column="version" property="version" jdbcType="INTEGER"/>
        <result column="create_time" property="createTime" jdbcType="TIMESTAMP"/>
        <result column="create_by" property="createBy" jdbcType="VARCHAR"/>
        <result column="modify_time" property="modifyTime" jdbcType="TIMESTAMP"/>
        <result column="modify_by" property="modifyBy" jdbcType="VARCHAR"/>
        <association property="financeSubject" javaType="com.zb.fincore.ams.service.dal.model.FinanceSubject">
            <id column="financeSubject_id" property="id" jdbcType="BIGINT"/>
            <result column="subject_code" property="subjectCode" jdbcType="VARCHAR"/>
            <result column="subject_name" property="subjectName" jdbcType="VARCHAR"/>
            <result column="cert_type" property="certType" jdbcType="TINYINT"/>
            <result column="cert_no" property="certNo" jdbcType="VARCHAR"/>
            <result column="registered_capital" property="registeredCapital" jdbcType="DECIMAL"/>
            <result column="subject_address" property="subjectAddress" jdbcType="VARCHAR"/>
            <result column="legal_person_name" property="legalPersonName" jdbcType="VARCHAR"/>
            <result column="legal_person_cert_no" property="legalPersonCertNo" jdbcType="VARCHAR"/>
            <result column="business_scope" property="businessScope" jdbcType="LONGVARCHAR"/>
            <result column="introduction" property="introduction" jdbcType="LONGVARCHAR"/>
            <result column="financeSubject_create_time" property="createTime" jdbcType="TIMESTAMP"/>
            <result column="financeSubject_create_by" property="createBy" jdbcType="VARCHAR"/>
            <result column="financeSubject_modify_time" property="modifyTime" jdbcType="TIMESTAMP"/>
            <result column="financeSubject_modify_by" property="modifyBy" jdbcType="VARCHAR"/>
        </association>
        <association property="issuePlan" javaType="com.zb.fincore.ams.service.dal.model.IssuePlan">
            <id column="plan_id" property="id" jdbcType="BIGINT" />
            <result column="plan_credit_business_code" property="creditBusinessCode" jdbcType="VARCHAR" />
            <result column="plan_batch_no" property="batchNo" jdbcType="VARCHAR" />
            <result column="plan_product_day_count" property="productDayCount" jdbcType="INTEGER" />
            <result column="plan_contract_day_count" property="contractDayCount" jdbcType="INTEGER" />
            <result column="plan_value_start_time" property="valueStartTime" jdbcType="TIMESTAMP" />
            <result column="plan_value_end_time" property="valueEndTime" jdbcType="TIMESTAMP" />
            <result column="plan_free_start_time" property="freeStartTime" jdbcType="TIMESTAMP" />
            <result column="plan_free_end_time" property="freeEndTime" jdbcType="TIMESTAMP" />
            <result column="plan_sale_start_time" property="saleStartTime" jdbcType="TIMESTAMP" />
            <result column="plan_sale_end_time" property="saleEndTime" jdbcType="TIMESTAMP" />
            <result column="plan_product_value_start_time" property="productValueStartTime" jdbcType="TIMESTAMP" />
            <result column="plan_product_value_end_time" property="productValueEndTime" jdbcType="TIMESTAMP" />
            <result column="plan_single_amount" property="singleAmount" jdbcType="DECIMAL" />
            <result column="plan_asset_count" property="assetCount" jdbcType="INTEGER" />
            <result column="plan_total_amount" property="totalAmount" jdbcType="DECIMAL" />
            <result column="plan_subject_code" property="subjectCode" jdbcType="VARCHAR" />
        </association>
    </resultMap>

    <resultMap id="UnPackageResultMap" type="com.zb.fincore.ams.service.dal.model.Asset">
        <id column="id" property="id" jdbcType="BIGINT"/>
        <result column="asset_code" property="assetCode" jdbcType="VARCHAR"/>
        <result column="ext_asset_code" property="extAssetCode" jdbcType="VARCHAR"/>
        <result column="asset_name" property="assetName" jdbcType="VARCHAR"/>
        <result column="asset_type" property="assetType" jdbcType="TINYINT"/>
        <result column="collect_status" property="collectStatus" jdbcType="TINYINT"/>
        <result column="approval_require_sign" property="approvalRequireSign" jdbcType="VARCHAR"/>
        <result column="approval_sign" property="approvalSign" jdbcType="VARCHAR"/>
        <result column="approval_status" property="approvalStatus" jdbcType="TINYINT"/>
        <result column="asset_amount" property="assetAmount" jdbcType="DECIMAL"/>
        <result column="distribute_amount" property="distributeAmount" jdbcType="DECIMAL"/>
        <result column="stock_amount" property="stockAmount" jdbcType="DECIMAL"/>
        <result column="frozen_amount" property="frozenAmount" jdbcType="DECIMAL"/>
        <result column="sale_amount" property="saleAmount" jdbcType="DECIMAL"/>
        <result column="finance_subject_id" property="financeSubjectId" jdbcType="BIGINT"/>
        <result column="finance_subject_code" property="financeSubjectCode" jdbcType="VARCHAR"/>
        <result column="establish_time" property="establishTime" jdbcType="TIMESTAMP"/>
        <result column="value_start_time" property="valueStartTime" jdbcType="TIMESTAMP"/>
        <result column="value_end_time" property="valueEndTime" jdbcType="TIMESTAMP"/>
        <result column="expire_time" property="expireTime" jdbcType="TIMESTAMP"/>
        <result column="transfer_lock_days" property="transferLockDays" jdbcType="INTEGER"/>
        <result column="value_days" property="valueDays" jdbcType="INTEGER"/>
        <result column="yield_rate" property="yieldRate" jdbcType="DECIMAL"/>
        <result column="min_invest_amount" property="minInvestAmount" jdbcType="DECIMAL"/>
        <result column="increase_amount" property="increaseAmount" jdbcType="DECIMAL"/>
        <result column="repayment_type" property="repaymentType" jdbcType="TINYINT"/>
        <result column="asset_desc" property="assetDesc" jdbcType="VARCHAR"/>
        <result column="finance_project" property="financeProject" jdbcType="VARCHAR"/>
        <result column="parent_asset_code" property="parentAssetCode" jdbcType="VARCHAR"/>
        <result column="provide_loan_code" property="provideLoanCode" jdbcType="VARCHAR"/>
        <result column="project_desc" property="projectDesc" jdbcType="LONGVARCHAR"/>
        <result column="repay_guarentee_mode" property="repayGuarenteeMode" jdbcType="LONGVARCHAR"/>
        <result column="credit_mode" property="creditMode" jdbcType="LONGVARCHAR"/>
        <result column="register_type" property="registerType" jdbcType="TINYINT"/>
        <result column="storage_status" property="storageStatus" jdbcType="TINYINT"/>
        <result column="publish_info" property="publishInfo" jdbcType="LONGVARCHAR"/>
        <result column="version" property="version" jdbcType="INTEGER"/>
        <result column="create_time" property="createTime" jdbcType="TIMESTAMP"/>
        <result column="create_by" property="createBy" jdbcType="VARCHAR"/>
        <result column="modify_time" property="modifyTime" jdbcType="TIMESTAMP"/>
        <result column="modify_by" property="modifyBy" jdbcType="VARCHAR"/>
        <association property="financeSubject" javaType="com.zb.fincore.ams.service.dal.model.FinanceSubject">
            <id column="financeSubject_id" property="id" jdbcType="BIGINT"/>
            <result column="subject_code" property="subjectCode" jdbcType="VARCHAR"/>
            <result column="subject_name" property="subjectName" jdbcType="VARCHAR"/>
            <result column="cert_type" property="certType" jdbcType="TINYINT"/>
            <result column="cert_no" property="certNo" jdbcType="VARCHAR"/>
            <result column="registered_capital" property="registeredCapital" jdbcType="DECIMAL"/>
            <result column="subject_address" property="subjectAddress" jdbcType="VARCHAR"/>
            <result column="legal_person_name" property="legalPersonName" jdbcType="VARCHAR"/>
            <result column="legal_person_cert_no" property="legalPersonCertNo" jdbcType="VARCHAR"/>
            <result column="business_scope" property="businessScope" jdbcType="LONGVARCHAR"/>
            <result column="introduction" property="introduction" jdbcType="LONGVARCHAR"/>
            <result column="financeSubject_create_time" property="createTime" jdbcType="TIMESTAMP"/>
            <result column="financeSubject_create_by" property="createBy" jdbcType="VARCHAR"/>
            <result column="financeSubject_modify_time" property="modifyTime" jdbcType="TIMESTAMP"/>
            <result column="financeSubject_modify_by" property="modifyBy" jdbcType="VARCHAR"/>
        </association>
        <association property="businessCredit" javaType="com.zb.fincore.ams.service.dal.model.BusinessCredit">
            <id column="credit_id" property="id" jdbcType="BIGINT"/>
            <result column="credit_batch_no" property="batchNo" jdbcType="VARCHAR"/>
            <result column="credit_credit_business_code" property="creditBusinessCode" jdbcType="VARCHAR"/>
            <result column="credit_credit_limit_amount" property="creditLimitAmount" jdbcType="DECIMAL"/>
            <result column="credit_financing_name" property="financingName" jdbcType="VARCHAR"/>
            <result column="credit_cert_no" property="certNo" jdbcType="VARCHAR"/>
            <result column="credit_legal_person_name" property="legalPersonName" jdbcType="VARCHAR"/>
            <result column="credit_contact_way" property="contactWay" jdbcType="VARCHAR"/>
            <result column="credit_address" property="address" jdbcType="VARCHAR"/>
            <result column="credit_financing_purpose" property="financingPurpose" jdbcType="VARCHAR"/>
            <result column="credit_yield_rate" property="yieldRate" jdbcType="DECIMAL"/>
            <result column="credit_value_start_time" property="valueStartTime" jdbcType="TIMESTAMP"/>
            <result column="credit_value_end_time" property="valueEndTime" jdbcType="TIMESTAMP"/>
            <result column="credit_day_count" property="dayCount" jdbcType="INTEGER"/>
            <result column="credit_repayment_type" property="repaymentType" jdbcType="INTEGER"/>
        </association>
        <association property="approval" javaType="com.zb.fincore.ams.service.dal.model.AssetApproval">
            <id column="approval_id" property="id" jdbcType="BIGINT"/>
            <result column="approval_asset_id" property="assetId" jdbcType="BIGINT"/>
            <result column="approval_asset_code" property="assetCode" jdbcType="VARCHAR"/>
            <result column="approval_approval_sign" property="sign" jdbcType="VARCHAR"/>
            <result column="approval_approval_status" property="approvalStatus" jdbcType="TINYINT"/>
            <result column="approval_approval_suggestion" property="approvalSuggestion" jdbcType="VARCHAR"/>
            <result column="approval_approval_by" property="approvalBy" jdbcType="VARCHAR"/>
            <result column="approval_time" property="approvalTime" jdbcType="TIMESTAMP"/>
            <result column="approval_create_time" property="createTime" jdbcType="TIMESTAMP"/>
            <result column="approval_create_by" property="createBy" jdbcType="VARCHAR"/>
        </association>
    </resultMap>

    <sql id="Base_Column_List">
        id, asset_code, ext_asset_code,asset_name, asset_type, collect_status,
        approval_require_sign, approval_sign, approval_status, asset_amount,
        distribute_amount, stock_amount, frozen_amount, sale_amount,
        finance_subject_id, finance_subject_code, establish_time, value_start_time,
        value_end_time, expire_time, transfer_lock_days, value_days,
        yield_rate, min_invest_amount,increase_amount, repayment_type, asset_desc,
        finance_project, parent_asset_code,provide_loan_code,
        project_desc, repay_guarentee_mode, credit_mode, version,register_type,
        storage_status, publish_info,
        create_time, create_by, modify_time, modify_by
    </sql>

    <sql id="filterSql">
        where 1=1
          and (register_type is null or register_type = 1)
            <if test="id != null">
                and id = #{id,jdbcType=BIGINT}
            </if>
            <if test="assetCode != null and assetCode != ''">
                and asset_code LIKE concat(concat('%', #{assetCode,jdbcType=VARCHAR}),'%')
            </if>
            <if test="assetName != null and assetName != ''">
                and asset_name LIKE concat(concat('%', #{assetName,jdbcType=VARCHAR}),'%')
            </if>
            <if test="assetType != null">
                and asset_type = #{assetType,jdbcType=TINYINT}
            </if>
            <if test="collectStatus != null">
                and collect_status = #{collectStatus,jdbcType=TINYINT}
            </if>
            <if test="approvalStatus != null">
                and approval_status = #{approvalStatus,jdbcType=TINYINT}
            </if>
            <if test="financeSubjectId != null">
                and finance_subject_id = #{financeSubjectId,jdbcType=BIGINT}
            </if>
            <if test="financeSubjectCode != null and financeSubjectCode != ''">
                and finance_subject_code = #{financeSubjectCode,jdbcType=VARCHAR}
            </if>
    </sql>

    <sql id="sortSql">
        <if test="sortField != null and sortType != null">
            <if test="sortField == 1">
                ORDER BY asset_code
            </if>
            <if test="sortField == 2">
                ORDER BY sale_amount
            </if>
            <if test="sortField == 3">
                ORDER BY stock_amount
            </if>
            <if test="sortField == 4">
                ORDER BY value_days
            </if>
            <if test="sortField == 5">
                ORDER BY expire_time
            </if>
            <if test="sortType == 1">
                ASC
            </if>
            <if test="sortType == 2">
                DESC
            </if>
        </if>
    </sql>

    <select id="selectByPrimaryKey" resultMap="BaseResultMap" parameterType="java.lang.Long">
        select
        <include refid="Base_Column_List"/>
        from ams_asset
        where id = #{id,jdbcType=BIGINT}
    </select>

    <select id="selectByCode" resultMap="BaseResultMap" parameterType="java.lang.String">
        select
        <include refid="Base_Column_List"/>
        from ams_asset
        where asset_code = #{assetCode,jdbcType=VARCHAR}
    </select>

	<select id="selectByExtAssetCode" resultMap="BaseResultMap" parameterType="java.lang.String">
        select
        <include refid="Base_Column_List"/>
        from ams_asset
        where ext_asset_code = #{extAssetCode,jdbcType=VARCHAR}
    </select>
    
    <select id="selectCount" resultType="java.lang.Integer"
            parameterType="com.zb.fincore.ams.service.dal.model.Asset">
        select
        COUNT(1)
        from ams_asset
        <include refid="filterSql"/>
    </select>

    <select id="select" resultMap="BaseResultMap" parameterType="com.zb.fincore.ams.service.dal.model.Asset">
        select
        <include refid="Base_Column_List"/>
        from ams_asset
        <include refid="filterSql"/>
        <include refid="sortSql"/>
    </select>

    <select id="selectDetailByCode" resultMap="AssetDetailResultMap"
            parameterType="com.zb.fincore.ams.service.dal.model.Asset">
        select  asset.id, asset.asset_code, asset.ext_asset_code,asset.asset_name, asset.asset_type, asset.collect_status,
        asset.approval_require_sign, asset.approval_sign, asset.approval_status, asset.asset_amount,
        asset.distribute_amount, asset.stock_amount, asset.frozen_amount, asset.sale_amount,
        asset.finance_subject_id, asset.finance_subject_code, asset.establish_time, asset.value_start_time,
        asset.value_end_time, asset.expire_time, asset.transfer_lock_days, asset.value_days,
        asset.yield_rate, asset.min_invest_amount,asset.increase_amount, asset.repayment_type, asset.asset_desc,
        asset.finance_project, asset.parent_asset_code,asset.provide_loan_code,
        asset.project_desc, asset.repay_guarentee_mode, asset.credit_mode,asset.register_type, asset.storage_status,
        asset.publish_info,
        asset.version,asset.create_time, asset.create_by, asset.modify_time, asset.modify_by,
        financeSubject.id as financeSubject_id, financeSubject.subject_code, financeSubject.subject_name, financeSubject.cert_type,
        financeSubject.cert_no, financeSubject.registered_capital, financeSubject.subject_address,
        financeSubject.legal_person_name, financeSubject.legal_person_cert_no, financeSubject.business_scope,
        financeSubject.introduction, financeSubject.create_time as financeSubject_create_time,
        financeSubject.create_by as financeSubject_create_by, financeSubject.modify_time as financeSubject_modify_time,
        financeSubject.modify_by as financeSubject_modify_by
        from ams_asset asset
        LEFT JOIN ams_finance_subject financeSubject on asset.finance_subject_code = financeSubject.subject_code
        where asset.asset_code = #{assetCode,jdbcType=VARCHAR}
    </select>

    <!--资产详情列表sql-->
    <sql id="selectDetailSql">
            where register_type != 2
            <if test="id != null">
                and asset.id = #{id,jdbcType=BIGINT}
            </if>
            <if test="assetCode != null and assetCode != ''">
                and asset.asset_code LIKE concat(concat('%', #{assetCode,jdbcType=VARCHAR}),'%')
            </if>
            <if test="assetName != null and assetName != ''">
                and asset.asset_name LIKE concat(concat('%', #{assetName,jdbcType=VARCHAR}),'%')
            </if>
            <if test="assetType != null">
                and asset.asset_type = #{assetType,jdbcType=TINYINT}
            </if>
            <if test="collectStatus != null">
                and asset.collect_status = #{collectStatus,jdbcType=TINYINT}
            </if>
            <if test="approvalStatus != null">
                and asset.approval_status = #{approvalStatus,jdbcType=TINYINT}
            </if>
            <if test="financeSubjectId != null">
                and asset.finance_subject_id = #{financeSubjectId,jdbcType=BIGINT}
            </if>
            <if test="financeSubjectCode != null and financeSubjectCode != ''">
                and asset.finance_subject_code = #{financeSubjectCode,jdbcType=VARCHAR}
            </if>
            <if test="beginCreateTime != null and beginCreateTime != ''">
                and DATE_FORMAT(asset.create_time,'%Y-%m-%d') >= '${beginCreateTime}'
            </if>
            <if test="endCreateTime != null and endCreateTime != ''">
                and DATE_FORMAT(asset.create_time,'%Y-%m-%d') &lt;= '${endCreateTime}'
            </if>
            <if test="registerType != null">
                and asset.register_type = #{registerType,jdbcType=TINYINT}
            </if>
            <if test="extAssetCode != null and extAssetCode != ''">
                and asset.ext_asset_code = #{extAssetCode,jdbcType=VARCHAR}
            </if>
    </sql>
    <!--资产详情列表数量-->
    <select id="selectDetailCount" resultType="java.lang.Integer"
            parameterType="com.zb.fincore.ams.service.dal.model.Asset">
        select count(1)
        from ams_asset asset
        LEFT JOIN ams_finance_subject financeSubject on asset.finance_subject_code = financeSubject.subject_code
        <include refid="selectDetailSql"/>
    </select>

    <!--资产详情列表-->
    <select id="selectDetail" resultMap="AssetDetailResultMap"
            parameterType="com.zb.fincore.ams.service.dal.model.Asset">
        select asset.id, asset.asset_code, asset.ext_asset_code,asset.asset_name, asset.asset_type, asset.collect_status,
        asset.approval_require_sign, asset.approval_sign, asset.approval_status, asset.asset_amount,
        asset.distribute_amount, asset.stock_amount, asset.frozen_amount, asset.sale_amount,
        asset.finance_subject_id, asset.finance_subject_code, asset.establish_time, asset.value_start_time,
        asset.value_end_time, asset.expire_time, asset.transfer_lock_days, asset.value_days,
        asset.yield_rate, asset.min_invest_amount,asset.increase_amount, asset.repayment_type, asset.asset_desc,
        asset.finance_project, asset.parent_asset_code,asset.provide_loan_code,
        asset.project_desc, asset.repay_guarentee_mode, asset.credit_mode,asset.register_type,
        asset.storage_status, asset.publish_info,
        asset.version,asset.create_time, asset.create_by, asset.modify_time, asset.modify_by,
        financeSubject.id as financeSubject_id, financeSubject.subject_code, financeSubject.subject_name,
        financeSubject.cert_type,
        financeSubject.cert_no, financeSubject.registered_capital, financeSubject.subject_address,
        financeSubject.legal_person_name, financeSubject.legal_person_cert_no, financeSubject.business_scope,
        financeSubject.introduction, financeSubject.create_time as financeSubject_create_time,
        financeSubject.create_by as financeSubject_create_by, financeSubject.modify_time as financeSubject_modify_time,
        financeSubject.modify_by as financeSubject_modify_by
        from ams_asset asset
        LEFT JOIN ams_finance_subject financeSubject on asset.finance_subject_code = financeSubject.subject_code
        <include refid="selectDetailSql"/>
        ORDER BY asset.create_time desc,asset.asset_code asc
    </select>

    <delete id="deleteByPrimaryKey" parameterType="java.lang.Long">
        delete from ams_asset
        where id = #{id,jdbcType=BIGINT}
    </delete>
    <insert id="insert" parameterType="com.zb.fincore.ams.service.dal.model.Asset"
            useGeneratedKeys="true" keyProperty="id">
        insert into ams_asset (asset_code, ext_asset_code,asset_name,
        asset_type, collect_status,
        approval_require_sign, approval_sign, approval_status,
        asset_amount, distribute_amount, stock_amount, frozen_amount,
        sale_amount, finance_subject_id, finance_subject_code,
        establish_time, value_start_time, value_end_time,
        expire_time, transfer_lock_days, value_days,
        yield_rate, min_invest_amount, increase_amount,
        repayment_type, asset_desc,
        finance_project, parent_asset_code,provide_loan_code,
        project_desc, repay_guarentee_mode, credit_mode,
        create_by, modify_by
        )
        values (#{assetCode,jdbcType=VARCHAR}, #{extAssetCode,jdbcType=VARCHAR},#{assetName,jdbcType=VARCHAR},
        #{assetType,jdbcType=TINYINT}, #{financeProjectId,jdbcType=BIGINT},
        #{financeProjectCode,jdbcType=VARCHAR},#{collectStatus,jdbcType=TINYINT},
        #{approvalRequireSign,jdbcType=VARCHAR}, #{approvalSign,jdbcType=VARCHAR}, #{approvalStatus,jdbcType=TINYINT},
        #{assetAmount,jdbcType=DECIMAL}, #{distributeAmount,jdbcType=DECIMAL}, #{stockAmount,jdbcType=DECIMAL},
        #{frozenAmount,jdbcType=DECIMAL},
        #{saleAmount,jdbcType=DECIMAL}, #{financeSubjectId,jdbcType=BIGINT}, #{financeSubjectCode,jdbcType=VARCHAR},
        #{establishTime,jdbcType=TIMESTAMP}, #{valueStartTime,jdbcType=TIMESTAMP}, #{valueEndTime,jdbcType=TIMESTAMP},
        #{expireTime,jdbcType=TIMESTAMP}, #{transferLockDays,jdbcType=INTEGER}, #{valueDays,jdbcType=INTEGER},
        #{yieldRate,jdbcType=DECIMAL}, #{minInvestAmount,jdbcType=DECIMAL}, #{increaseAmount,jdbcType=DECIMAL},
        #{repaymentType,jdbcType=TINYINT}, #{assetDesc,jdbcType=VARCHAR},
        #{financeProject,jdbcType=VARCHAR},
        #{parentAssetCode,jdbcType=VARCHAR},#{provideLoanCode,jdbcType=VARCHAR},
        #{projectDesc,jdbcType=LONGVARCHAR},
        #{repayGuarenteeMode,jdbcType=LONGVARCHAR},#{creditMode,jdbcType=LONGVARCHAR},
        #{createBy,jdbcType=VARCHAR}, #{modifyBy,jdbcType=VARCHAR}
        )
    </insert>
    <insert id="insertSelective" parameterType="com.zb.fincore.ams.service.dal.model.Asset"
            useGeneratedKeys="true" keyProperty="id">
        insert into ams_asset
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="assetCode != null">
                asset_code,
            </if>
            <if test="extAssetCode != null">
                ext_asset_code,
            </if>
            <if test="assetName != null">
                asset_name,
            </if>
            <if test="assetType != null">
                asset_type,
            </if>
            <if test="collectStatus != null">
                collect_status,
            </if>
            <if test="approvalRequireSign != null">
                approval_require_sign,
            </if>
            <if test="approvalSign != null">
                approval_sign,
            </if>
            <if test="approvalStatus != null">
                approval_status,
            </if>
            <if test="assetAmount != null">
                asset_amount,
            </if>
            <if test="distributeAmount != null">
                distribute_amount,
            </if>
            <if test="stockAmount != null">
                stock_amount,
            </if>
            <if test="frozenAmount != null">
                frozen_amount,
            </if>
            <if test="saleAmount != null">
                sale_amount,
            </if>
            <if test="financeSubjectId != null">
                finance_subject_id,
            </if>
            <if test="financeSubjectCode != null">
                finance_subject_code,
            </if>
            <if test="establishTime != null">
                establish_time,
            </if>
            <if test="valueStartTime != null">
                value_start_time,
            </if>
            <if test="valueEndTime != null">
                value_end_time,
            </if>
            <if test="expireTime != null">
                expire_time,
            </if>
            <if test="transferLockDays != null">
                transfer_lock_days,
            </if>
            <if test="valueDays != null">
                value_days,
            </if>
            <if test="yieldRate != null">
                yield_rate,
            </if>
            <if test="minInvestAmount != null">
                min_invest_amount,
            </if>
            <if test="increaseAmount != null">
                increase_amount,
            </if>
            <if test="repaymentType != null">
                repayment_type,
            </if>
            <if test="assetDesc != null">
                asset_desc,
            </if>
            <if test="financeProject != null">
                finance_project,
            </if>
            <if test="parentAssetCode != null">
                parent_asset_code,
            </if>
            <if test="provideLoanCode != null">
                provide_loan_code,
            </if>
            <if test="projectDesc != null">
                project_desc,
            </if>
            <if test="repayGuarenteeMode != null">
                repay_guarentee_mode,
            </if>
            <if test="creditMode != null">
                credit_mode,
            </if>
            <if test="registerType != null">
                register_type,
            </if>
            <if test="storageStatus != null">
                storage_status,
            </if>
            <if test="publishInfo != null">
                publish_info,
            </if>
            <if test="createBy != null">
                create_by,
            </if>
            <if test="modifyBy != null">
                modify_by,
            </if>
        </trim>
        <trim prefix="values (" suffix=")" suffixOverrides=",">
            <if test="assetCode != null">
                #{assetCode,jdbcType=VARCHAR},
            </if>
            <if test="extAssetCode != null">
                #{extAssetCode,jdbcType=VARCHAR},
            </if>
            <if test="assetName != null">
                #{assetName,jdbcType=VARCHAR},
            </if>
            <if test="assetType != null">
                #{assetType,jdbcType=TINYINT},
            </if>
            <if test="collectStatus != null">
                #{collectStatus,jdbcType=TINYINT},
            </if>
            <if test="approvalRequireSign != null">
                #{approvalRequireSign,jdbcType=VARCHAR},
            </if>
            <if test="approvalSign != null">
                #{approvalSign,jdbcType=VARCHAR},
            </if>
            <if test="approvalStatus != null">
                #{approvalStatus,jdbcType=TINYINT},
            </if>
            <if test="assetAmount != null">
                #{assetAmount,jdbcType=DECIMAL},
            </if>
            <if test="distributeAmount != null">
                #{distributeAmount,jdbcType=DECIMAL},
            </if>
            <if test="stockAmount != null">
                #{stockAmount,jdbcType=DECIMAL},
            </if>
            <if test="frozenAmount != null">
                #{frozenAmount,jdbcType=DECIMAL},
            </if>
            <if test="saleAmount != null">
                #{saleAmount,jdbcType=DECIMAL},
            </if>
            <if test="financeSubjectId != null">
                #{financeSubjectId,jdbcType=BIGINT},
            </if>
            <if test="financeSubjectCode != null">
                #{financeSubjectCode,jdbcType=VARCHAR},
            </if>
            <if test="establishTime != null">
                #{establishTime,jdbcType=TIMESTAMP},
            </if>
            <if test="valueStartTime != null">
                #{valueStartTime,jdbcType=TIMESTAMP},
            </if>
            <if test="valueEndTime != null">
                #{valueEndTime,jdbcType=TIMESTAMP},
            </if>
            <if test="expireTime != null">
                #{expireTime,jdbcType=TIMESTAMP},
            </if>
            <if test="transferLockDays != null">
                #{transferLockDays,jdbcType=INTEGER},
            </if>
            <if test="valueDays != null">
                #{valueDays,jdbcType=INTEGER},
            </if>
            <if test="yieldRate != null">
                #{yieldRate,jdbcType=DECIMAL},
            </if>
            <if test="minInvestAmount != null">
                #{minInvestAmount,jdbcType=DECIMAL},
            </if>
            <if test="increaseAmount != null">
                #{increaseAmount,jdbcType=DECIMAL},
            </if>
            <if test="repaymentType != null">
                #{repaymentType,jdbcType=TINYINT},
            </if>
            <if test="assetDesc != null">
                #{assetDesc,jdbcType=VARCHAR},
            </if>
            <if test="financeProject != null">
                #{financeProject,jdbcType=VARCHAR},
            </if>
            <if test="parentAssetCode != null">
                #{parentAssetCode,jdbcType=VARCHAR},
            </if>
            <if test="provideLoanCode != null">
                #{provideLoanCode,jdbcType=VARCHAR},
            </if>
            <if test="projectDesc != null">
                #{projectDesc,jdbcType=LONGVARCHAR},
            </if>
            <if test="repayGuarenteeMode != null">
                #{repayGuarenteeMode,jdbcType=LONGVARCHAR},
            </if>
            <if test="creditMode != null">
                #{creditMode,jdbcType=LONGVARCHAR},
            </if>
            <if test="registerType != null">
                #{registerType,jdbcType=TINYINT},
            </if>
            <if test="storageStatus != null">
                #{storageStatus,jdbcType=TINYINT},
            </if>
            <if test="publishInfo != null">
                #{publishInfo,jdbcType=LONGVARCHAR},
            </if>
            <if test="createBy != null">
                #{createBy,jdbcType=VARCHAR},
            </if>
            <if test="modifyBy != null">
                #{modifyBy,jdbcType=VARCHAR},
            </if>
        </trim>
    </insert>

    <update id="batchUpdateWithLock" parameterType="java.util.List">
        <foreach collection="list" item="item" index="index" open="" close="" separator=";">
            update ams_asset
            <set>
                <if test="item.assetCode != null">
                    asset_code = #{item.assetCode,jdbcType=VARCHAR},
                </if>
                <if test="item.extAssetCode != null">
                    extAssetCode = #{item.extAssetCode,jdbcType=VARCHAR},
                </if>
                <if test="item.assetName != null">
                    asset_name = #{item.assetName,jdbcType=VARCHAR},
                </if>
                <if test="item.assetType != null">
                    asset_type = #{item.assetType,jdbcType=TINYINT},
                </if>
                <if test="item.collectStatus != null">
                    collect_status = #{item.collectStatus,jdbcType=TINYINT},
                </if>
                <if test="item.approvalRequireSign != null">
                    approval_require_sign = #{item.approvalRequireSign,jdbcType=VARCHAR},
                </if>
                <if test="item.approvalSign != null">
                    approval_sign = #{item.approvalSign,jdbcType=VARCHAR},
                </if>
                <if test="item.approvalStatus != null">
                    approval_status = #{item.approvalStatus,jdbcType=TINYINT},
                </if>
                <if test="item.assetAmount != null">
                    asset_amount = #{item.assetAmount,jdbcType=DECIMAL},
                </if>
                <if test="item.distributeAmount != null">
                    distribute_amount = #{item.distributeAmount,jdbcType=DECIMAL},
                </if>
                <if test="item.stockAmount != null">
                    stock_amount = #{item.stockAmount,jdbcType=DECIMAL},
                </if>
                <if test="item.frozenAmount != null">
                    frozen_amount = #{item.frozenAmount,jdbcType=DECIMAL},
                </if>
                <if test="item.saleAmount != null">
                    sale_amount = #{item.saleAmount,jdbcType=DECIMAL},
                </if>
                <if test="item.financeSubjectId != null">
                    finance_subject_id = #{item.financeSubjectId,jdbcType=BIGINT},
                </if>
                <if test="item.financeSubjectCode != null">
                    finance_subject_code = #{item.financeSubjectCode,jdbcType=VARCHAR},
                </if>
                <if test="item.establishTime != null">
                    establish_time = #{item.establishTime,jdbcType=TIMESTAMP},
                </if>
                <if test="item.valueStartTime != null">
                    value_start_time = #{item.valueStartTime,jdbcType=TIMESTAMP},
                </if>
                <if test="item.valueEndTime != null">
                    value_end_time = #{item.valueEndTime,jdbcType=TIMESTAMP},
                </if>
                <if test="item.expireTime != null">
                    expire_time = #{item.expireTime,jdbcType=TIMESTAMP},
                </if>
                <if test="item.transferLockDays != null">
                    transfer_lock_days = #{item.transferLockDays,jdbcType=INTEGER},
                </if>
                <if test="item.valueDays != null">
                    value_days = #{item.valueDays,jdbcType=INTEGER},
                </if>
                <if test="item.yieldRate != null">
                    yield_rate = #{item.yieldRate,jdbcType=DECIMAL},
                </if>
                <if test="item.minInvestAmount != null">
                    min_invest_amount = #{item.minInvestAmount,jdbcType=DECIMAL},
                </if>
                <if test="item.increaseAmount != null">
                    increase_amount = #{item.increaseAmount,jdbcType=DECIMAL},
                </if>
                <if test="item.repaymentType != null">
                    repayment_type = #{item.repaymentType,jdbcType=TINYINT},
                </if>
                <if test="item.assetDesc != null">
                    asset_desc = #{item.assetDesc,jdbcType=VARCHAR},
                </if>
                <if test="item.financeProject != null">
                    finance_project = #{item.financeProject,jdbcType=VARCHAR},
                </if>
                <if test="item.projectDesc != null">
                    project_desc = #{item.projectDesc,jdbcType=LONGVARCHAR},
                </if>
                <if test="item.repayGuarenteeMode != null">
                    repay_guarentee_mode = #{item.repayGuarenteeMode,jdbcType=LONGVARCHAR},
                </if>
                <if test="item.creditMode != null">
                    credit_mode = #{item.creditMode,jdbcType=LONGVARCHAR},
                </if>
                <if test="item.registerType != null">
                    register_type = #{item.registerType,jdbcType=TINYINT},
                </if>
                <if test="item.storageStatus != null">
                    storage_status = #{item.storageStatus,jdbcType=TINYINT},
                </if>
                <if test="item.modifyBy != null">
                    modify_by = #{item.modifyBy,jdbcType=VARCHAR},
                </if>
                <if test="item.version != null">
                    version = version + 1,
                </if>
            </set>
            where id = #{item.id,jdbcType=BIGINT} and version = #{item.version,jdbcType=INTEGER}
        </foreach>
    </update>

    <update id="updateSelectiveWithLock" parameterType="com.zb.fincore.ams.service.dal.model.Asset">
        update ams_asset
        <set>
            <if test="assetCode != null">
                asset_code = #{assetCode,jdbcType=VARCHAR},
            </if>
            <if test="extAssetCode != null">
                ext_asset_code = #{extAssetCode,jdbcType=VARCHAR},
            </if>
            <if test="assetName != null">
                asset_name = #{assetName,jdbcType=VARCHAR},
            </if>
            <if test="assetType != null">
                asset_type = #{assetType,jdbcType=TINYINT},
            </if>
            <if test="collectStatus != null">
                collect_status = #{collectStatus,jdbcType=TINYINT},
            </if>
            <if test="approvalRequireSign != null">
                approval_require_sign = #{approvalRequireSign,jdbcType=VARCHAR},
            </if>
            <if test="approvalSign != null">
                approval_sign = #{approvalSign,jdbcType=VARCHAR},
            </if>
            <if test="approvalStatus != null">
                approval_status = #{approvalStatus,jdbcType=TINYINT},
            </if>
            <if test="assetAmount != null">
                asset_amount = #{assetAmount,jdbcType=DECIMAL},
            </if>
            <if test="distributeAmount != null">
                distribute_amount = #{distributeAmount,jdbcType=DECIMAL},
            </if>
            <if test="stockAmount != null">
                stock_amount = #{stockAmount,jdbcType=DECIMAL},
            </if>
            <if test="frozenAmount != null">
                frozen_amount = #{frozenAmount,jdbcType=DECIMAL},
            </if>
            <if test="saleAmount != null">
                sale_amount = #{saleAmount,jdbcType=DECIMAL},
            </if>
            <if test="financeSubjectId != null">
                finance_subject_id = #{financeSubjectId,jdbcType=BIGINT},
            </if>
            <if test="financeSubjectCode != null">
                finance_subject_code = #{financeSubjectCode,jdbcType=VARCHAR},
            </if>
            <if test="establishTime != null">
                establish_time = #{establishTime,jdbcType=TIMESTAMP},
            </if>
            <if test="valueStartTime != null">
                value_start_time = #{valueStartTime,jdbcType=TIMESTAMP},
            </if>
            <if test="valueEndTime != null">
                value_end_time = #{valueEndTime,jdbcType=TIMESTAMP},
            </if>
            <if test="expireTime != null">
                expire_time = #{expireTime,jdbcType=TIMESTAMP},
            </if>
            <if test="transferLockDays != null">
                transfer_lock_days = #{transferLockDays,jdbcType=INTEGER},
            </if>
            <if test="valueDays != null">
                value_days = #{valueDays,jdbcType=INTEGER},
            </if>
            <if test="yieldRate != null">
                yield_rate = #{yieldRate,jdbcType=DECIMAL},
            </if>
            <if test="minInvestAmount != null">
                min_invest_amount = #{minInvestAmount,jdbcType=DECIMAL},
            </if>
            <if test="increaseAmount != null">
                increase_amount = #{increaseAmount,jdbcType=DECIMAL},
            </if>
            <if test="repaymentType != null">
                repayment_type = #{repaymentType,jdbcType=TINYINT},
            </if>
            <if test="assetDesc != null">
                asset_desc = #{assetDesc,jdbcType=VARCHAR},
            </if>
            <if test="financeProject != null">
                finance_project = #{financeProject,jdbcType=VARCHAR},
            </if>
            <if test="parentAssetCode != null">
                parent_asset_code = #{parentAssetCode,jdbcType=VARCHAR},
            </if>
            <if test="provideLoanCode != null">
                provide_loan_code = #{provideLoanCode,jdbcType=VARCHAR},
            </if>
            <if test="projectDesc != null">
                project_desc = #{projectDesc,jdbcType=LONGVARCHAR},
            </if>
            <if test="repayGuarenteeMode != null">
                repay_guarentee_mode = #{repayGuarenteeMode,jdbcType=LONGVARCHAR},
            </if>
            <if test="creditMode != null">
                credit_mode = #{creditMode,jdbcType=LONGVARCHAR},
            </if>
            <if test="registerType != null">
                register_type = #{registerType,jdbcType=TINYINT},
            </if>
            <if test="storageStatus != null">
                storage_status = #{storageStatus,jdbcType=TINYINT},
            </if>
            <if test="modifyBy != null">
                modify_by = #{modifyBy,jdbcType=VARCHAR},
            </if>
            version = version + 1
        </set>
        where id = #{id,jdbcType=BIGINT} and version = #{version,jdbcType=INTEGER}
    </update>

    <update id="updateByPrimaryKey" parameterType="com.zb.fincore.ams.service.dal.model.Asset">
        update ams_asset
        set asset_code = #{assetCode,jdbcType=VARCHAR},
        ext_asset_code = #{extAssetCode,jdbcType=VARCHAR},
        asset_name = #{assetName,jdbcType=VARCHAR},
        asset_type = #{assetType,jdbcType=TINYINT},
        collect_status = #{collectStatus,jdbcType=TINYINT},
        approval_require_sign = #{approvalRequireSign,jdbcType=VARCHAR},
        approval_sign = #{approvalSign,jdbcType=VARCHAR},
        approval_status = #{approvalStatus,jdbcType=TINYINT},
        asset_amount = #{assetAmount,jdbcType=DECIMAL},
        distribute_amount = #{distributeAmount,jdbcType=DECIMAL},
        stock_amount = #{stockAmount,jdbcType=DECIMAL},
        frozen_amount = #{frozenAmount,jdbcType=DECIMAL},
        sale_amount = #{saleAmount,jdbcType=DECIMAL},
        finance_subject_id = #{financeSubjectId,jdbcType=BIGINT},
        finance_subject_code = #{financeSubjectCode,jdbcType=VARCHAR},
        establish_time = #{establishTime,jdbcType=TIMESTAMP},
        value_start_time = #{valueStartTime,jdbcType=TIMESTAMP},
        value_end_time = #{valueEndTime,jdbcType=TIMESTAMP},
        expire_time = #{expireTime,jdbcType=TIMESTAMP},
        transfer_lock_days = #{transferLockDays,jdbcType=INTEGER},
        value_days = #{valueDays,jdbcType=INTEGER},
        yield_rate = #{yieldRate,jdbcType=DECIMAL},
        min_invest_amount = #{minInvestAmount,jdbcType=DECIMAL},
        increase_amount = #{increaseAmount,jdbcType=DECIMAL},
        repayment_type = #{repaymentType,jdbcType=TINYINT},
        asset_desc = #{assetDesc,jdbcType=VARCHAR},
        finance_project = #{financeProject,jdbcType=VARCHAR},
        project_desc = #{projectDesc,jdbcType=LONGVARCHAR},
        repay_guarentee_mode = #{repayGuarenteeMode,jdbcType=LONGVARCHAR},
        credit_mode = #{creditMode,jdbcType=LONGVARCHAR},
        register_type = #{registerType,jdbcType=TINYINT},
        storage_status = #{storageStatus,jdbcType=TINYINT},
        publish_info = #{publishInfo,jdbcType=LONGVARCHAR},
        modify_by = #{modifyBy,jdbcType=VARCHAR}
        where id = #{id,jdbcType=BIGINT}
    </update>

    <!--交易资产名称是否重复-->
    <select id="selectAssetCountByName" resultType="java.lang.Integer"
            parameterType="java.lang.String">
        select COUNT(1)
        from ams_asset
        where asset_name = #{assetName,jdbcType=VARCHAR}
    </select>

    <!--查询资产池可匹配资产-->
    <select id="queryPoolAssetList" resultMap="AssetDetailResultMap"
            parameterType="com.zb.fincore.ams.service.dal.model.Asset">
        select asset.id, asset.asset_code, asset.ext_asset_code,asset.asset_name, asset.asset_type, asset.collect_status,
        asset.approval_require_sign, asset.approval_sign, asset.approval_status, asset.asset_amount,
        asset.distribute_amount, asset.stock_amount, asset.frozen_amount, asset.sale_amount,
        asset.finance_subject_id, asset.finance_subject_code, asset.establish_time, asset.value_start_time,
        asset.value_end_time, asset.expire_time, asset.transfer_lock_days, asset.value_days,
        asset.yield_rate, asset.min_invest_amount,asset.increase_amount, asset.repayment_type, asset.asset_desc,
        asset.finance_project,asset.parent_asset_code,asset.provide_loan_code,
        asset.project_desc, asset.repay_guarentee_mode, asset.credit_mode,asset.register_type,
        asset.storage_status, asset.publish_info, asset.version,
        asset.create_time, asset.create_by, asset.modify_time, asset.modify_by,
        financeSubject.id as financeSubject_id, financeSubject.subject_code, financeSubject.subject_name,
        financeSubject.cert_type,
        financeSubject.cert_no, financeSubject.registered_capital, financeSubject.subject_address,
        financeSubject.legal_person_name, financeSubject.legal_person_cert_no, financeSubject.business_scope,
        financeSubject.introduction, financeSubject.create_time as financeSubject_create_time,
        financeSubject.create_by as financeSubject_create_by, financeSubject.modify_time as financeSubject_modify_time,
        financeSubject.modify_by as financeSubject_modify_by
        from ams_asset asset
        LEFT JOIN ams_finance_subject financeSubject on asset.finance_subject_code = financeSubject.subject_code
        where approval_status = #{approvalStatus,jdbcType=TINYINT}
        and finance_subject_code = #{financeSubjectCode,jdbcType=VARCHAR}
        and collect_status = #{collectStatus,jdbcType=TINYINT}
        and distribute_amount = 0
        and (register_type = #{registerType,jdbcType=TINYINT} or register_type is null)
        order by asset_amount desc
    </select>

    <!--查询资产池可匹配资产数目-->
    <select id="queryPoolAssetListCount" resultType="java.lang.Integer"
            parameterType="com.zb.fincore.ams.service.dal.model.Asset">
        select count(1)
        from ams_asset
        where approval_status = #{approvalStatus,jdbcType=TINYINT}
        and finance_subject_code = #{financeSubjectCode,jdbcType=VARCHAR}
        and collect_status = #{collectStatus,jdbcType=TINYINT}
        and distribute_amount = 0
        and (register_type = #{registerType,jdbcType=TINYINT} or register_type is null)
    </select>

    <!--查询待成立或到期资产-->
    <select id="queryAssetListForJob" resultMap="BaseResultMap"
            parameterType="com.zb.fincore.ams.service.dal.model.Asset">
        select
        <include refid="Base_Column_List"/>
        from ams_asset
        <where>
            <if test="id != null">
                and id = #{id,jdbcType=BIGINT}
            </if>
            <if test="assetCode != null and assetCode != ''">
                and asset_code LIKE concat(concat('%', #{assetCode,jdbcType=VARCHAR}),'%')
            </if>
            <if test="assetName != null and assetName != ''">
                and asset_name LIKE concat(concat('%', #{assetName,jdbcType=VARCHAR}),'%')
            </if>
            <if test="assetType != null">
                and asset_type = #{assetType,jdbcType=TINYINT}
            </if>
            <if test="collectStatus != null">
                and collect_status = #{collectStatus,jdbcType=TINYINT}
            </if>
            <if test="approvalStatus != null">
                and approval_status = #{approvalStatus,jdbcType=TINYINT}
            </if>
            <if test="financeSubjectId != null">
                and finance_subject_id = #{financeSubjectId,jdbcType=BIGINT}
            </if>
            <if test="financeSubjectCode != null and financeSubjectCode != ''">
                and finance_subject_code = #{financeSubjectCode,jdbcType=VARCHAR}
            </if>
            <if test="valueStartTime != null">
                and DATE_FORMAT(value_start_time,'%Y-%m-%d') &lt;=
                DATE_FORMAT(#{valueStartTime,jdbcType=TIMESTAMP},'%Y-%m-%d')
            </if>
            <if test="expireTime != null">
                and DATE_FORMAT(expire_time,'%Y-%m-%d') &lt;= DATE_FORMAT(#{expireTime,jdbcType=TIMESTAMP},'%Y-%m-%d')
            </if>
        </where>
    </select>

    <!--查询授信资产录入审核列表sql-->
    <sql id="creditAssetSql">
        <if test="valueStartTime != null and valueStartTime != ''">
            and DATE_FORMAT(asset.value_start_time,'%Y-%m-%d') =
            DATE_FORMAT(#{valueStartTime,jdbcType=TIMESTAMP},'%Y-%m-%d')
        </if>
        <if test="valueEndTime != null and valueStartTime != ''">
            and DATE_FORMAT(asset.value_end_time,'%Y-%m-%d') =
            DATE_FORMAT(#{valueEndTime,jdbcType=TIMESTAMP},'%Y-%m-%d')
        </if>
        <if test="sign != null and sign != ''">
            and left(asset.approval_require_sign,1) = #{sign,jdbcType=VARCHAR}
        </if>
        <if test="repaymentType != null">
            and asset.repayment_type = #{repaymentType,jdbcType=TINYINT}
        </if>
        <if test='sign != null and sign == "B"'>
            AND (select count(DISTINCT relation1.asset_code) from ams_asset_issue_relation relation1 LEFT JOIN ams_asset
            asset2
            on asset2.asset_code = relation1.asset_code where relation1.batch_no = relation.batch_no
            and asset2.approval_status = '2')
            = ((select count(DISTINCT relation2.asset_code) from ams_asset_issue_relation relation2
            LEFT JOIN ams_asset_approval approval ON relation2.asset_code = approval.asset_code where approval.sign =
            'A'
            and relation2.batch_no = relation.batch_no) - (select count(DISTINCT relation2.asset_code) from
            ams_asset_issue_relation relation2
            LEFT JOIN ams_asset_approval approval ON relation2.asset_code = approval.asset_code where approval.sign =
            'B'
            and relation2.batch_no = relation.batch_no))
        </if>
    </sql>

    <!--授信资产-->
    <sql id="Credit_Asset_Column_List">
        asset.id, asset.asset_code,asset.ext_asset_code, asset.asset_name, asset.asset_type, asset.collect_status,
        asset.approval_require_sign, asset.approval_sign, asset.approval_status, asset.asset_amount,
        asset.distribute_amount, asset.stock_amount, asset.frozen_amount, asset.sale_amount,
        asset.finance_subject_id, asset.finance_subject_code, asset.establish_time, asset.value_start_time,
        asset.value_end_time, asset.expire_time, asset.transfer_lock_days, asset.value_days,
        asset.yield_rate, asset.min_invest_amount,asset.increase_amount, asset.repayment_type, asset.asset_desc,
        asset.finance_project,asset.parent_asset_code,asset.provide_loan_code,
        asset.project_desc, asset.repay_guarentee_mode, asset.credit_mode, asset.version,asset.register_type,
        asset.storage_status, asset.publish_info,
        asset.create_time, asset.create_by, asset.modify_time, asset.modify_by
    </sql>

    <!--查询授信资产录入审核列表数量-->
    <select id="queryCreditAssetListForApprovalCount" resultType="java.lang.Integer" parameterType="java.util.Map">
        select COUNT(1)
        from ams_asset asset LEFT JOIN ams_asset_issue_relation relation on asset.asset_code = relation.asset_code
        where asset.register_type = '2'
        <include refid="creditAssetSql"/>
        and asset.approval_status = '2'
    </select>

    <select id="queryCreditAssetListForApproval" resultMap="BaseResultMap" parameterType="java.util.Map">
        select
        <include refid="Credit_Asset_Column_List"/>
        ,relation.batch_no
        from ams_asset asset left join ams_asset_issue_relation relation
        on relation.asset_code = asset.asset_code
        where asset.register_type = '2'
        <include refid="creditAssetSql"/>
        and asset.approval_status = '2'
        order by asset.create_time desc
    </select>

    <!--授信资产-->
    <sql id="UnPackage_Asset_Column_List">
        asset.id, asset.asset_code, asset.ext_asset_code, asset.asset_name, asset.asset_type, asset.collect_status,
        asset.approval_require_sign, asset.approval_sign, asset.approval_status, asset.asset_amount,
        asset.distribute_amount, asset.stock_amount, asset.frozen_amount, asset.sale_amount,
        asset.finance_subject_id, asset.finance_subject_code, asset.establish_time, asset.value_start_time,
        asset.value_end_time, asset.expire_time, asset.transfer_lock_days, asset.value_days,
        asset.yield_rate, asset.min_invest_amount,asset.increase_amount, asset.repayment_type, asset.asset_desc,
        asset.finance_project, asset.parent_asset_code,asset.provide_loan_code,
        asset.project_desc, asset.repay_guarentee_mode, asset.credit_mode, asset.version,asset.register_type,
        asset.storage_status, asset.publish_info,
        asset.create_time, asset.create_by, asset.modify_time, asset.modify_by,
        financeSubject.id as financeSubject_id, financeSubject.subject_code, financeSubject.subject_name, financeSubject.cert_type,
        financeSubject.cert_no, financeSubject.registered_capital, financeSubject.subject_address,
        financeSubject.legal_person_name, financeSubject.legal_person_cert_no, financeSubject.business_scope,
        financeSubject.introduction, financeSubject.create_time as financeSubject_create_time,
        financeSubject.create_by as financeSubject_create_by, financeSubject.modify_time as financeSubject_modify_time,
        financeSubject.modify_by as financeSubject_modify_by,
        credit.id as credit_id, credit.batch_no as credit_batch_no, credit.credit_business_code as credit_credit_business_code,
        credit.credit_limit_amount as credit_credit_limit_amount, credit.financing_name as credit_financing_name,
        credit.cert_no as credit_cert_no,credit.legal_person_name as credit_legal_person_name, credit.contact_way as credit_contact_way,
        credit.address as credit_address, credit.financing_purpose as credit_financing_purpose, credit.yield_rate as credit_yield_rate,
        credit.value_start_time as credit_value_start_time,credit.value_end_time as credit_value_end_time,
        credit.day_count as credit_day_count, credit.repayment_type as credit_repayment_type,
        approval.id as approval_id, approval.asset_id as approval_asset_id, approval.asset_code as approval_asset_code,
        approval.sign as approval_approval_sign, approval.approval_status as approval_approval_status,
        approval.approval_suggestion as approval_approval_suggestion, approval.approval_by as approval_approval_by,
        approval.approval_time, approval.create_time as approval_create_time, approval.create_by as approval_create_by
    </sql>

    <!--查询授信资产合同列表sql-->
    <sql id="queryUnPackageAssetSql">
        <if test="assetCode != null and assetCode != ''">
            and asset.asset_code = #{assetCode,jdbcType=VARCHAR}
        </if>
        <if test="assetName != null and assetName != ''">
            and asset_name LIKE concat(concat('%', #{assetName,jdbcType=VARCHAR}),'%')
        </if>
        <if test="financeName != null and financeName != ''">
            and credit.financing_name LIKE concat(concat('%', #{financeName,jdbcType=VARCHAR}),'%')
        </if>
        <if test="approvalStartTime != null and approvalStartTime != ''">
            and DATE_FORMAT(approval.approval_time,'%Y-%m-%d') &gt;=
            DATE_FORMAT(#{approvalStartTime,jdbcType=TIMESTAMP},'%Y-%m-%d')
        </if>
        <if test="approvalEndTime != null and approvalEndTime != ''">
            and DATE_FORMAT(approval.approval_time,'%Y-%m-%d') &lt;=
            DATE_FORMAT(#{approvalEndTime,jdbcType=TIMESTAMP},'%Y-%m-%d')
        </if>
        <if test="contractStatus == 1">
            and NOT EXISTS (SELECT 1 from ams_file_template_param param
              where param.asset_code = asset.asset_code and param.status = #{templateStatus,jdbcType=TINYINT})
        </if>
        <if test="contractStatus == 2">
            and EXISTS (SELECT 1 from ams_file_template_param param
              where param.asset_code = asset.asset_code and param.status = #{templateStatus,jdbcType=TINYINT})
        </if>
    </sql>

    <!--查询授信资产合同列表数量-->
    <select id="queryUnPackageAssetListCount" resultType="java.lang.Integer" parameterType="java.util.Map">
        select COUNT(1) from
          (select batch_no from
            (
            select issue_relation.batch_no,count(asset.asset_code) as cnt from ams_asset_issue_relation issue_relation
            left join ams_asset asset on asset.asset_code = issue_relation.asset_code and asset.approval_status != #{approvalStatus,jdbcType=TINYINT}
            group by issue_relation.batch_no
            ) rel
            where cnt = 0
          ) rel1
        LEFT JOIN ams_asset_issue_relation issue_relation1 on rel1.batch_no = issue_relation1.batch_no
        LEFT JOIN ams_asset asset on asset.asset_code = issue_relation1.asset_code and asset.register_type = #{registerType,jdbcType=TINYINT}
        LEFT JOIN ams_finance_subject financeSubject ON asset.finance_subject_code = financeSubject.subject_code
        LEFT JOIN ams_business_credit credit ON credit.batch_no = rel1.batch_no
        LEFT JOIN ams_asset_approval approval ON approval.asset_code = asset.asset_code and approval.approval_status = #{approvalStatus,jdbcType=TINYINT}
        where 1=1
        <include refid="queryUnPackageAssetSql"/>
    </select>

    <!--查询授信资产合同列表-->
    <select id="queryUnPackageAssetList" resultMap="UnPackageResultMap" parameterType="java.util.Map">
        select
        <include refid="UnPackage_Asset_Column_List"/>
        from (select batch_no from
        (
        select issue_relation.batch_no,count(asset.asset_code) as cnt from ams_asset_issue_relation issue_relation
        left join ams_asset asset on asset.asset_code = issue_relation.asset_code and asset.approval_status != #{approvalStatus,jdbcType=TINYINT}
        group by issue_relation.batch_no
        ) rel
        where cnt = 0
        ) rel1
        LEFT JOIN ams_asset_issue_relation issue_relation1 on rel1.batch_no = issue_relation1.batch_no
        LEFT JOIN ams_asset asset on asset.asset_code = issue_relation1.asset_code and asset.register_type = #{registerType,jdbcType=TINYINT}
        LEFT JOIN ams_finance_subject financeSubject ON asset.finance_subject_code = financeSubject.subject_code
        LEFT JOIN ams_business_credit credit ON credit.batch_no = rel1.batch_no
        LEFT JOIN ams_asset_approval approval ON approval.asset_code = asset.asset_code and approval.approval_status = #{approvalStatus,jdbcType=TINYINT}
        where 1=1
        <include refid="queryUnPackageAssetSql"/>
        order by asset.create_time desc
    </select>

    <!--查询备案资产列表sql-->
    <sql id="queryRecordAssetListSql">
        <if test="assetCode != null and assetCode != ''">
            and asset.asset_code = #{assetCode,jdbcType=VARCHAR}
        </if>
        <if test="assetName != null and assetName != ''">
            and asset_name LIKE concat(concat('%', #{assetName,jdbcType=VARCHAR}),'%')
        </if>
        <if test="financeName != null and financeName != ''">
            and credit.financing_name LIKE concat(concat('%', #{financeName,jdbcType=VARCHAR}),'%')
        </if>
        <if test="startValueTime != null and startValueTime != ''">
            and DATE_FORMAT(asset.value_start_time,'%Y-%m-%d') &gt;=
            DATE_FORMAT(#{startValueTime,jdbcType=TIMESTAMP},'%Y-%m-%d')
        </if>
        <if test="endValueTime != null and endValueTime != ''">
            and DATE_FORMAT(asset.value_start_time,'%Y-%m-%d') &lt;=
            DATE_FORMAT(#{endValueTime,jdbcType=TIMESTAMP},'%Y-%m-%d')
        </if>
        <if test="batchNo != null and batchNo != ''">
            and relation.batch_no = #{batchNo,jdbcType=VARCHAR}
        </if>
        <if test="approvalStatus != null">
            and asset.approval_status = #{approvalStatus,jdbcType=TINYINT}
        </if>
        <if test="registerType != null">
            and asset.register_type = #{registerType,jdbcType=TINYINT}
        </if>
        <if test="templateCode != null and templateCode != ''">
            and (SELECT count(1) from ams_file_template_param param
            where param.asset_code = asset.asset_code and param.template_code != #{templateCode,jdbcType=VARCHAR}
            and param.status = 2) &gt; 0
        </if>
        <if test="contractStatus == 1">
            and NOT EXISTS (SELECT 1 from ams_file_template_param param
            where param.asset_code = asset.asset_code and param.status = 2
            and param.template_code = #{templateCode,jdbcType=VARCHAR})
        </if>
        <if test="contractStatus == 2">
            and EXISTS (SELECT 1 from ams_file_template_param param
            where param.asset_code = asset.asset_code and param.status = #{contractStatus,jdbcType=TINYINT}
            and param.template_code = #{templateCode,jdbcType=VARCHAR})
        </if>
    </sql>

    <sql id="Record_Asset_Column_List">
        asset.id, asset.asset_code, asset.ext_asset_code, asset.asset_name, asset.asset_type, asset.collect_status,
        asset.approval_require_sign, asset.approval_sign, asset.approval_status, asset.asset_amount,
        asset.distribute_amount, asset.stock_amount, asset.frozen_amount, asset.sale_amount,
        asset.finance_subject_id, asset.finance_subject_code, asset.establish_time, asset.value_start_time,
        asset.value_end_time, asset.expire_time, asset.transfer_lock_days, asset.value_days,
        asset.yield_rate, asset.min_invest_amount,asset.increase_amount, asset.repayment_type, asset.asset_desc,
        asset.finance_project, asset.parent_asset_code,asset.provide_loan_code,
        asset.project_desc, asset.repay_guarentee_mode, asset.credit_mode, asset.version,asset.register_type,
        asset.storage_status, asset.publish_info,
        asset.create_time, asset.create_by, asset.modify_time, asset.modify_by,
        financeSubject.id as financeSubject_id, financeSubject.subject_code, financeSubject.subject_name, financeSubject.cert_type,
        financeSubject.cert_no, financeSubject.registered_capital, financeSubject.subject_address,
        financeSubject.legal_person_name, financeSubject.legal_person_cert_no, financeSubject.business_scope,
        financeSubject.introduction, financeSubject.create_time as financeSubject_create_time,
        financeSubject.create_by as financeSubject_create_by, financeSubject.modify_time as financeSubject_modify_time,
        financeSubject.modify_by as financeSubject_modify_by,
        plan.id as plan_id, plan.credit_business_code as plan_credit_business_code,
        plan.batch_no as plan_batch_no, plan.product_day_count as plan_product_day_count,
        plan.contract_day_count as plan_contract_day_count, plan.value_start_time as plan_value_start_time,
        plan.value_end_time as plan_value_end_time, plan.free_start_time as plan_free_start_time,
        plan.free_end_time as plan_free_end_time, plan.sale_start_time as plan_sale_start_time,
        plan.sale_end_time as plan_sale_end_time, plan.product_value_start_time as plan_product_value_start_time,
        plan.product_value_end_time as plan_product_value_end_time, plan.single_amount as plan_single_amount,
        plan.asset_count as plan_asset_count, plan.total_amount as plan_total_amount,
        plan.subject_code as plan_subject_code
    </sql>

    <!--查询备案资产列表数量-->
    <select id="queryRecordAssetListCount" resultType="java.lang.Integer" parameterType="java.util.Map">
        select COUNT(1)
        from ams_asset asset
        LEFT JOIN ams_finance_subject financeSubject on asset.finance_subject_code = financeSubject.subject_code
        LEFT JOIN ams_asset_issue_relation relation on relation.asset_code = asset.asset_code
        LEFT JOIN ams_business_credit credit on credit.batch_no = relation.batch_no
        LEFT JOIN ams_issue_plan plan ON plan.id = relation.issue_id
        where 1=1
        and asset.publish_info is not null
        <include refid="queryRecordAssetListSql"/>
    </select>

    <!--查询备案资产列表-->
    <select id="queryRecordAssetList" resultMap="AssetRecordResultMap" parameterType="java.util.Map">
        select <include refid="Record_Asset_Column_List"/>
        from ams_asset asset
        LEFT JOIN ams_finance_subject financeSubject on asset.finance_subject_code = financeSubject.subject_code
        LEFT JOIN ams_asset_issue_relation relation on relation.asset_code = asset.asset_code
        LEFT JOIN ams_business_credit credit on credit.batch_no = relation.batch_no
        LEFT JOIN ams_issue_plan plan ON plan.id = relation.issue_id
        where 1=1
        and asset.publish_info is not null
        <include refid="queryRecordAssetListSql"/>
        order by asset.create_time desc
    </select>

    <!--根据备案批次号查询资产-->
    <select id="selectAssetListByBatchNo" resultMap="BaseResultMap" parameterType="java.lang.String">
        SELECT <include refid="Credit_Asset_Column_List"/>
        FROM ams_asset asset
        LEFT JOIN ams_asset_issue_relation relation ON relation.asset_code = asset.asset_code
        LEFT JOIN ams_business_credit credit ON credit.batch_no = relation.batch_no
        where relation.batch_no = #{batchNo,jdbcType=VARCHAR}
    </select>

    <update id="updatePublishInfo" parameterType="com.zb.fincore.ams.service.dal.model.Asset">
        update ams_asset
        set publish_info = #{publishInfo,jdbcType=LONGVARCHAR}, version = version + 1
        where id = #{id,jdbcType=BIGINT}
    </update>

    <!--查询唐小僧资产导入列表-->
    <select id="queryAssetListForTxs" resultMap="BaseResultMap" parameterType="java.util.Map">
        select <include refid="Credit_Asset_Column_List"/>
        from ams_asset asset LEFT JOIN ams_asset_exchange_register register
        on register.asset_code = asset.asset_code
        where 1=1
        and asset.distribute_amount = 0
        and DATE_FORMAT(date_add(asset.expire_time, interval + 1 day),'%Y-%m-%d')  &gt;=  DATE_FORMAT(now(),'%Y-%m-%d')
        <if test="storageStatus != null">
            and asset.storage_status = #{storageStatus,jdbcType=TINYINT}
        </if>
        <if test="registerType != null">
            and asset.register_type = #{registerType,jdbcType=TINYINT}
        </if>
        <if test="approvalStatus != null">
            and asset.approval_status = #{approvalStatus,jdbcType=TINYINT}
        </if>
        <if test="registerStatus != null">
            and register.register_status = #{registerStatus,jdbcType=VARCHAR}
        </if>
    </select>
</mapper>